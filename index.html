<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voicemeeter Macro Buttons Command Generator</title>
  <meta name="description" content="Single-view, tri-state menus, real-time Voicemeeter command preview/exports with language switch">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">üéöÔ∏è</div>
        <div class="titles">
          <h1 id="t-title">Voicemeeter Macro Buttons Command Generator</h1>
          <p id="t-subtitle" class="subtitle"></p>
        </div>
      </div>
      <div class="controls">
        <label class="ver-label" id="t-version-label">Version:</label>
        <select id="versionSelect" class="select">
          <option value="standard">Voicemeeter (Standard)</option>
          <option value="banana">Voicemeeter Banana</option>
          <option value="potato">Voicemeeter Potato</option>
        </select>
        <label class="ver-label" id="t-lang-label">Language:</label>
        <select id="langSelect" class="select">
          <option value="en">English</option>
          <option value="zh">ÁπÅÈ´î‰∏≠Êñá</option>
        </select>
        <button id="copyBtn" class="ghost">Copy</button>
        <button id="resetBtn" class="danger">Reset All</button>
        <button id="helpBtn" class="ghost">Help</button>
      </div>
    </header>

    <main class="content">
      <section class="left-pane">
        <div class="panel">
          <div class="panel-title" id="t-panel-title">Visual Panel (set on the left, see diff on the right)</div>
          <div class="panel-subtitle" id="panelSubtitle"></div>

          <div class="tabs" role="tablist">
            <button class="tab active" data-tab="strips" id="t-tab-strips">Strips (Inputs)</button>
            <button class="tab" data-tab="buses" id="t-tab-buses">Buses (Outputs)</button>
            <button class="tab" data-tab="quick" id="t-tab-quick">Quick Commands / Snippets</button>
            <button class="tab" data-tab="system" id="t-tab-system">System / VBAN / Recorder / Patch</button>
          </div>

          <div class="tabpane active" id="tab-strips">
            <div class="selector-row">
              <label id="t-select-strip">Select Strip:</label>
              <select id="stripIndexSelect" class="select" title="Index"></select>
            </div>
            <div id="stripSingle"></div>
          </div>

          <div class="tabpane" id="tab-buses">
            <div class="selector-row">
              <label id="t-select-bus">Select Bus:</label>
              <select id="busIndexSelect" class="select" title="Index"></select>
            </div>
            <div id="busSingle"></div>
          </div>

          <div class="tabpane" id="tab-quick">
            <div class="quick-grid">
              <div class="quick-card">
                <h3 id="t-q-mute-title">Mute / Unmute / Toggle</h3>
                <div class="row">
                  <label id="t-q-strip-index">Strip Index</label>
                  <input type="number" id="qcMuteStripIndex" min="0" value="0">
                </div>
                <div class="row">
                  <label id="t-q-action">Action</label>
                  <select id="qcMuteAction">
                    <option value="on">ON (=1)</option>
                    <option value="off">OFF (=0)</option>
                    <option value="toggle">TOGGLE (+=1)</option>
                  </select>
                </div>
                <button class="primary" id="qcMuteAdd">Add</button>
                <pre class="preview" id="qcMutePreview"></pre>
              </div>

              <div class="quick-card">
                <h3 id="t-q-gain-title">Strip Gain / Fade</h3>
                <div class="row">
                  <label id="t-q-strip-index-2">Strip Index</label>
                  <input type="number" id="qcGainStripIndex" min="-1" value="0">
                </div>
                <div class="row">
                  <label id="t-q-gain-db">Target Gain (dB)</label>
                  <input type="number" id="qcGainDb" step="0.1" min="-60" max="12" value="-6">
                </div>
                <div class="row">
                  <label id="t-q-gain-ms">Fade Time (ms)</label>
                  <input type="number" id="qcGainMs" min="0" value="1000">
                </div>
                <button class="primary" id="qcGainAdd">Add</button>
                <pre class="preview" id="qcGainPreview"></pre>
              </div>

              <div class="quick-card">
                <h3 id="t-q-assign-title">Assign to Bus (A1..A5 / B1..B3)</h3>
                <div class="row">
                  <label id="t-q-strip-index-3">Strip Index</label>
                  <input type="number" id="qcAssignStripIndex" min="0" value="0">
                </div>
                <div class="row">
                  <label id="t-q-target">Target</label>
                  <select id="qcAssignTarget">
                    <option value="A1">A1</option>
                    <option value="A2">A2</option>
                    <option value="A3">A3</option>
                    <option value="A4">A4</option>
                    <option value="A5">A5</option>
                    <option value="B1">B1</option>
                    <option value="B2">B2</option>
                    <option value="B3">B3</option>
                  </select>
                </div>
                <div class="row">
                  <label id="t-q-value">Value</label>
                  <select id="qcAssignValue">
                    <option value="1">1 (ON)</option>
                    <option value="0">0 (OFF)</option>
                  </select>
                </div>
                <button class="primary" id="qcAssignAdd">Add</button>
                <pre class="preview" id="qcAssignPreview"></pre>
              </div>

              <div class="quick-card">
                <h3 id="t-q-cmd-title">Special Commands (Command.*)</h3>
                <div class="row">
                  <label id="t-q-cmd">Command</label>
                  <select id="qcCmdName">
                    <option value="Restart">Restart</option>
                    <option value="Shutdown">Shutdown</option>
                    <option value="Reset">Reset</option>
                    <option value="Show">Show</option>
                    <option value="Lock">Lock</option>
                    <option value="Eject">Eject</option>
                  </select>
                </div>
                <div class="row">
                  <label id="t-q-valpath">Value / Path</label>
                  <input type="text" id="qcCmdValue" placeholder='e.g. 1 or "C:\\My Documents\\VMConfig1.xml"'>
                </div>
                <button class="primary" id="qcCmdAdd">Add</button>
                <pre class="preview" id="qcCmdPreview"></pre>
              </div>

              <div class="quick-card">
                <h3 id="t-q-wait-title">Wait Sequence (ms)</h3>
                <div class="row">
                  <label id="t-q-wait">Wait Time</label>
                  <input type="number" id="qcWaitMs" min="0" value="1000">
                </div>
                <button class="primary" id="qcWaitAdd">Add</button>
                <pre class="preview" id="qcWaitPreview"></pre>
              </div>
            </div>
          </div>

          <div class="tabpane" id="tab-system">
            <div class="sys-grid">
              <div class="sys-card">
                <h3>System Settings</h3>
                <div class="row">
                  <label>Option.sr</label>
                  <select id="optSr">
                    <option>44.1</option><option selected>48</option><option>88.2</option><option>96</option><option>176.4</option><option>192</option>
                  </select>
                  <button class="mini ghost" data-insert="Option.sr {{VAL}} kHz">Add</button>
                </div>
                <div class="row">
                  <label>Option.ASIOsr</label>
                  <select id="optAsiosr">
                    <option value="0">0 (default)</option>
                    <option value="1">1 (preferred)</option>
                  </select>
                  <button class="mini ghost" data-insert="Option.ASIOsr = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>Option.buffer.wdm</label>
                  <input type="number" id="optBufWdm" value="512" min="128" max="2048" step="64">
                  <button class="mini ghost" data-insert="Option.buffer.wdm = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>Option.mode.exclusif</label>
                  <select id="optExcl"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="Option.mode.exclusif = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>Option.mode.swift</label>
                  <select id="optSwift"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="Option.mode.swift = {{VAL}};">Add</button>
                </div>
              </div>

              <div class="sys-card">
                <h3>VBAN</h3>
                <div class="row">
                  <label>vban.Enable</label>
                  <select id="vbanEnable"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="vban.Enable = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>vban.outstream[0].name</label>
                  <input type="text" id="vbanOutName" placeholder="e.g. SendA">
                  <button class="mini ghost" data-insert='vban.outstream[0].name = "{{VAL}}";'>Add</button>
                </div>
                <div class="row">
                  <label>vban.outstream[0].ip</label>
                  <input type="text" id="vbanOutIp" placeholder="192.168.1.50">
                  <button class="mini ghost" data-insert='vban.outstream[0].ip = "{{VAL}}";'>Add</button>
                </div>
                <div class="row">
                  <label>vban.outstream[0].sr</label>
                  <select id="vbanOutSr"><option>44100</option><option selected>48000</option><option>96000</option></select>
                  <button class="mini ghost" data-insert="vban.outstream[0].sr = {{VAL}};">Add</button>
                </div>
              </div>

              <div class="sys-card">
                <h3>Recorder</h3>
                <div class="row">
                  <label>recorder.record</label>
                  <select id="recRecord"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="recorder.record = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>recorder.play</label>
                  <select id="recPlay"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="recorder.play = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>Recorder.FileType</label>
                  <select id="recFileType"><option value="1">1=WAV</option><option value="100">100=MP3</option></select>
                  <button class="mini ghost" data-insert="Recorder.FileType = {{VAL}};">Add</button>
                </div>
              </div>

              <div class="sys-card">
                <h3>Patch</h3>
                <div class="row">
                  <label>Patch.composite[0]</label>
                  <input id="patchComposite0" type="number" value="0" min="0" max="22">
                  <button class="mini ghost" data-insert="Patch.composite[0] = {{VAL}};">Add</button>
                </div>
                <div class="row">
                  <label>Patch.insert[0]</label>
                  <select id="patchInsert0"><option>0</option><option>1</option></select>
                  <button class="mini ghost" data-insert="Patch.insert[0] = {{VAL}};">Add</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="right-pane">
        <div class="panel no-title">
          <pre id="finalPreview" class="preview huge"></pre>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span id="t-footer-note"></span>
    </footer>

  <dialog id="helpDialog">
    <form method="dialog" class="help">
      <div class="editor-header">
        <h3 id="t-help-title">Help / How to Use</h3>
        <button class="ghost" value="cancel" id="t-close">Close</button>
      </div>
      <div class="help-body">
        <ol class="steps" id="t-help-steps">
          <li>Choose Voicemeeter version. The left panel adapts to strip/bus counts and allowed options.</li>
          <li>In Strips/Buses tabs, use the index dropdown (0..n-1) to show exactly ONE channel at a time. Edit values.</li>
          <li>The right-hand preview outputs only changed items (no defaults).</li>
          <li>Use Quick / System to append extra lines (Wait, Command.*, VBAN, Recorder...). They are merged into Final Output.</li>
        </ol>
      </div>
    </form>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
